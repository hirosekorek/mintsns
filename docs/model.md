# モデル設計
TypeScript(フロント側)や、Postgres(バックエンド側)で共通して管理されるモデル論理設計です。

## Post(投稿、ポスト)
* メッセージ(本文)を持つ
* コメントができる
* Public投稿と Limited投稿がある
* Limtied投稿の場合、投稿したタイミングで指定されたゾーンにマッチするユーザーがその投稿を見られる(あとからユーザーがそのゾーンに入ってもその投稿を見ることはできない)
* タイムライン(ポストコレクション)は、InfluxDBで管理されます。
  * Postのゾーン情報や限定公開情報等はInfluxDBが管理し、この情報はあとで編集することが出来ません。
* メッセージは編集することが出来ます。
* 時間制限投稿(指定された時間を過ぎるとその投稿は削除される)
* ポストは投稿主情報を持ちます。
* ポイントを与えることができます。
  * ポイントは、絵文字に対応する予定です。
* 複数の画像を添付できます。

## Comment(コメント)
* ポストのリレーションとしてコメントコレクションを管理します。
* メッセージ(本文)をを持ちます。
* ひとつの画像を添付できます。

## User(ユーザー)
* Google アカウントでログインする
* Google のアイコンがそのまま使用される（予定)
* キャッチフレーズが編集できる
* ユーザーに設定されてあるタグ一覧が見れる
* ユーザーのタグは、他人もしくは自分によって投票できます。

## PostGavePointUser(ポストにポイントを与えたユーザー)
* ユーザーはポストに対してポイントを与えることができる
* ひとつのポストに対して、1つだけ投票することができる
* 投票時に絵文字を使って気持ちを伝えることができる

## CommentGavePointUser
* ユーザーはコメントに対してポイントを与えることができる
* ひとつのコメントに対して、1つだけ投票することができる
* 投票時に絵文字を使って気持ちを伝えることができる

## Notification
* 通知は100件以上の古いものは破棄する
* 通知の内容
  * コメントしたポストにコメントがありました
  * あなたのポストにコメントがありました
  * あなたの名前があります。(メンション通知)

## Stream(MainStream)
* Twitterのタイムラインのようなもの
* メインストリームは複数のZoneの条件にどれか一つでも当てはまった投稿が流れる
* Stream は ID的なものは持たず、子であるゾーン条件を使いタイムラインの中身を変化させる

## CustomStream
* ゾーンが設定されたストリームのこと
* ゾーンが設定されているので、流したい投稿を絞り込むことができる
* カスタムストリームは公開設定ができる。公開した場合は、おすすめのゾーンで紹介される。
* ここで公開されたゾーンを元に、投稿範囲をうまく調整することになる。

## Zone
* 実際にこの設定値を使ってどのようなタイムラインを配信するかは、 InfluxDB が決定する。
* ゾーンエディタがあり、ゾーンは自由に作成できる
* ゾーンは、自分のタグを見せる人を限定させる場合や、ストリームを作成する時に使用できる
* ↑<数字>と↓<数字>とxが指定できる。×はそのタグが含まれているユーザーは表示しない

## Tag
* ユーザー属性タグ
* 他人、または自分にタグをつけることができる
* タグは投票することができて、すでにあるタグに再び投票する場合は、タグポイントが加算される
* [Point] なぜ自分で自分にタグをつけられるのか
  * タグは一種類につき1ポイントしかつけることができないため、自分でタグを設定したところでは、2ポイント以上のゾーンが指定されてあるストリームを見れない。しかし、好きな趣味についてタグを設定してもらうのに他人にタグをつけてもらうようお願いすることが必ず発生してしまうし、サブアカウントで自分にタグをつけることもあるだろう。そのため、自分で自分にタグをつけるのは認める。
* タグは非公開設定できる（ただし非公開にしたタグはポイントがあがりにくくなる）
* タグにもゾーンを設定できる（あるゾーンに含まれているユーザーのみそのタグが見れる）

## MintPoint
* タグポイントの合計値のこと
* この数値の数によって人気度がわかる